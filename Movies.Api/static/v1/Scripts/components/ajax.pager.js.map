{"version":3,"sources":["ajax.pager.es6.js"],"names":["window","_proxy","getInterceptor","object","propertyName","attr","_data","setInterceptor","value","updatePostfixAddInterceptor","original","updatePostfixSubtractInterceptor","extend","tag","template","viewModel","Prev","Next","ChangePage","pageNumber","isToggled","checked","indexOf","toggle","undefined","push","splice","define","selectedRows","Value","can","Type","additionalData","additionalDataName","type","read","readType","Loading","get","_lastSet","resolve","promise","state","then","PaginatedItems","done","data","requestOptions","ajaxOptions","url","method","traditional","dataType","contentType","serialize","result","JSON","stringify","request","_requestOptions","$","ajax","Count","Offset","limit","limitName","currentPageName","CanNext","cannext","CanPrev","canprev","CurrentPage","Math","floor","set","newVal","parseInt","PageCount","ceil","HasPages","pageLimit","Pages","currentPage","pageCount","pageOffset","hasNonPage","_","times","i","pageTitle","isActive","isPage","events","trigger","selectedIds","resetGrid"],"mappings":"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","file":"ajax.pager.js","sourcesContent":["ï»¿import can from \"can.full\";\r\nimport $ from \"jquery\";\r\nimport _ from 'underscore';\r\n\r\nexport default can.Component.extend({\r\n    tag: \"ajax-pager\",\r\n    template: \"<content/>\",\r\n    viewModel: can.Map.extend({\r\n        Prev: function () {\r\n            if (this.CanPrev === true) {\r\n                this.Offset = this.Offset - this.limit;\r\n            }\r\n        },\r\n        Next: function () {\r\n            if (this.CanNext === true) {\r\n                this.Offset = this.Offset + this.limit;\r\n            }\r\n        },\r\n        ChangePage: function (pageNumber) {\r\n            this.CurrentPage = pageNumber;\r\n        },\r\n        isToggled: function (value) {\r\n            let checked = this.selectedRows.indexOf(value);\r\n            //set checked based on if current checkbox's value is in selectedIds.\r\n            return checked > -1;\r\n        },\r\n        toggle: function (value, toggle) {\r\n            if (toggle !== undefined && toggle !== null) {\r\n                if (toggle === true) {\r\n                    let checked = this.selectedRows.indexOf(value);\r\n                    if (checked === -1) {\r\n                        //add id to selectedIds.\r\n                        this.selectedRows.push(value);\r\n                    }\r\n                }\r\n                else {\r\n                    let checked = this.selectedRows.indexOf(value);\r\n                    if (checked > -1) {\r\n                        //remove id from selectedIds.\r\n                        this.selectedRows.splice(checked, 1);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                let checked = this.selectedRows.indexOf(value);\r\n                if (checked === -1) {\r\n                    //add id to selectedIds.\r\n                    this.selectedRows.push(value);\r\n                }\r\n                else {\r\n                    this.selectedRows.splice(checked, 1);\r\n                }\r\n            }\r\n        },\r\n        define: {\r\n            selectedRows: {\r\n                Value: can.List,\r\n                Type: can.List\r\n            },\r\n            additionalData: {\r\n                value: null\r\n            },\r\n            additionalDataName: {\r\n                type: \"string\",\r\n                value: null\r\n            },\r\n            read: {\r\n                type: \"string\",\r\n                value: null\r\n            },\r\n            readType: {\r\n                type: \"string\",\r\n                value: \"POST\"\r\n            },\r\n            Loading: {\r\n                get: function (_lastSet, resolve) {\r\n                    let promise = this.request;\r\n\r\n                    if (promise.state() === \"pending\") {\r\n                        promise.then(function () {\r\n                            resolve(false);\r\n                        });\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                }\r\n            },\r\n            PaginatedItems: {\r\n                get: function (_lastSet, resolve) {\r\n                    let promise = this.request;\r\n\r\n                    promise.done((data) => {\r\n                        this.Count = data.TotalCount;\r\n                        resolve(data.Items);\r\n                    });\r\n                }\r\n            },\r\n            requestOptions: {\r\n                type: '*',\r\n                get: function () {\r\n                    let ajaxOptions = {\r\n                        url: this.read,\r\n                        method: this.readType,\r\n                        traditional: true,\r\n                        dataType: this.dataType,\r\n                        contentType: this.contentType\r\n                    };\r\n                    let data = this.additionalData;\r\n                    if (data === null) {\r\n                        data = {};\r\n                    }\r\n                    if (data.serialize)\r\n                        data = data.serialize();\r\n                    if (this.additionalDataName) {\r\n                        let result = {};\r\n                        result[this.additionalDataName] = data;\r\n                        ajaxOptions.data = result;\r\n                    }\r\n                    else {\r\n                        ajaxOptions.data = data;\r\n                    }\r\n                    ajaxOptions.data[this.limitName] = this.limit;\r\n                    ajaxOptions.data[this.currentPageName] = this.CurrentPage;\r\n                    if (this.stringify) {\r\n                        ajaxOptions.data = JSON.stringify(ajaxOptions.data);\r\n                    }\r\n                    return ajaxOptions;\r\n                }\r\n            },\r\n            request: {\r\n                get: function (_requestOptions) {\r\n                    return $.ajax(this.requestOptions);\r\n                }\r\n            },\r\n            Count: {\r\n                type: \"number\",\r\n                value: 0\r\n            },\r\n            Offset: {\r\n                type: \"number\",\r\n                value: 0\r\n            },\r\n            limit: {\r\n                type: \"number\",\r\n                value: 10\r\n            },\r\n            limitName: {\r\n                type: 'string',\r\n                value: 'limit'\r\n            },\r\n            currentPageName: {\r\n                type: 'string',\r\n                value: 'currentPage'\r\n            },\r\n            dataType: {\r\n                type: 'string',\r\n                value: 'json'\r\n            },\r\n            contentType: {\r\n                type: 'string',\r\n                value: 'application/x-www-form-urlencoded; charset=UTF-8'\r\n            },\r\n            stringify: {\r\n                type: 'boolean',\r\n                value: false\r\n            },\r\n            CanNext: {\r\n                get: function () {\r\n                    let cannext = this.Offset < this.Count - this.limit;\r\n                    return cannext;\r\n                }\r\n            },\r\n            CanPrev: {\r\n                get: function () {\r\n                    let canprev = this.Offset > 0;\r\n                    return canprev;\r\n                }\r\n            },\r\n            CurrentPage: {\r\n                get: function () {\r\n                    return Math.floor(this.Offset / this.limit) + 1;\r\n                },\r\n                set: function (newVal) {\r\n                    this.Offset = (parseInt(newVal, 10) - 1) * this.limit;\r\n                }\r\n            },\r\n            PageCount: {\r\n                get: function () {\r\n                    return this.Count ?\r\n                        Math.ceil(this.Count / this.limit) : null;\r\n                }\r\n            },\r\n            HasPages: {\r\n                get: function () {\r\n                    return this.PageCount > 1;\r\n                }\r\n            },\r\n            pageLimit: {\r\n                type: \"number\",\r\n                value: 10\r\n            },\r\n            Pages: {\r\n                get: function () {\r\n                    let currentPage = this.CurrentPage;\r\n                    let pageCount = this.pageLimit;\r\n                    let pageOffset = currentPage - (pageCount / 2) > 0 ? Math.ceil(currentPage - (pageCount / 2)) : 0;\r\n                    var hasNonPage = true;\r\n                    if (pageOffset + pageCount > this.PageCount) {\r\n                        pageCount = this.PageCount - pageOffset;\r\n                        hasNonPage = false;\r\n                    }\r\n                    return new can.List(_.times(hasNonPage ? pageCount + 1 : pageCount, function (i) {\r\n                        if (i < pageCount) {\r\n                            return {\r\n                                pageNumber: pageOffset + i,\r\n                                pageTitle: pageOffset + i + 1,\r\n                                isActive: pageOffset + i + 1 === currentPage,\r\n                                isPage: true\r\n                            };\r\n                        }\r\n                        else {\r\n                            return {\r\n                                pageTitle: '...',\r\n                                isPage: false\r\n                            };\r\n                        }\r\n                    }));\r\n                }\r\n            }\r\n        }\r\n    }),\r\n    events: {\r\n        '{selectedRows} change': function () {\r\n            this.element.trigger('selectedrows', [{ selectedIds: this.viewModel.selectedRows.serialize() }]);\r\n        },\r\n        '{element} refresh': function () {\r\n            this.viewModel.request = this.viewModel.requestOptions;\r\n        },\r\n        '{element} clear': function () {\r\n            this.viewModel.selectedRows = [];\r\n            this.element.trigger('refresh');\r\n        },\r\n        \"{viewModel} additionalData set\": 'resetGrid',\r\n        \"{additionalData} change\": 'resetGrid',\r\n        resetGrid: function () {\r\n            this.viewModel.CurrentPage = 1;\r\n        }\r\n    }\r\n});"]}